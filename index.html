<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>Color Weaver – Path Debug with Coordinates</title>
<style>
  :root{ 
    --primary: #667eea;
    --primary-deep: #4c51bf;
    --secondary: #764ba2;
    --accent: #f093fb;
  }
  
  * { box-sizing: border-box; }
  
  html, body {
    height: 100%;
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, Arial;
  }
  
  /* Animated gradient background */
  @keyframes gradientShift {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
  }
  
  body {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #4facfe 75%, #667eea 100%);
    background-size: 400% 400%;
    animation: gradientShift 15s ease infinite;
    display: grid;
    place-items: center;
    position: relative;
  }
  
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background: radial-gradient(circle at 20% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 255, 255, 0.15) 0%, transparent 50%);
    pointer-events: none;
  }

  .screen {
    position: relative;
    width: min(430px, 100vw);
    height: calc(min(430px, 100vw) * 2);
    max-height: 100vh;
    overflow: hidden;
    border-radius: 28px;
    box-shadow: 0 25px 80px rgba(0, 0, 0, 0.4),
                0 0 0 1px rgba(255, 255, 255, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(20px);
  }
  
  .bg {
    position: absolute;
    inset: 0;
    background: 
      linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%),
      url('https://conghieu021299.github.io/color_weaver/img/background.png') center/cover no-repeat;
    z-index: 0;
    opacity: 0.95;
  }

  /* Floating animation for title */
  @keyframes float {
    0%, 100% { transform: translateX(-50%) translateY(0); }
    50% { transform: translateX(-50%) translateY(-10px); }
  }

  .title {
    position: absolute;
    top: 100px;
    left: 50%;
    transform: translateX(-50%);
    text-align: center;
    z-index: 1;
    animation: float 4s ease-in-out infinite;
  }
  
  .title .c {
    margin: 0;
    font-weight: 900;
    font-size: 56px;
    background: linear-gradient(135deg, #667eea 0%, #4facfe 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    filter: drop-shadow(0 4px 8px rgba(102, 126, 234, 0.4));
    letter-spacing: 2px;
  }
  
  .title .w {
    margin: -8px 0 0;
    font-weight: 900;
    font-size: 60px;
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    filter: drop-shadow(0 4px 8px rgba(240, 147, 251, 0.4));
    letter-spacing: 2px;
  }

  /* Level nodes with glow */
  @keyframes nodeGlow {
    0%, 100% { box-shadow: 0 0 20px rgba(102, 126, 234, 0.5); }
    50% { box-shadow: 0 0 30px rgba(102, 126, 234, 0.8); }
  }

  .node {
    --w: 80px;
    position: absolute;
    width: var(--w);
    height: calc(var(--w) * 0.92);
    border-radius: calc(var(--w) * 0.28);
    display: grid;
    place-items: center;
    transform: translate(-50%, -55%);
    font-weight: 900;
    font-size: calc(var(--w) * 0.42);
    color: #fff;
    text-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
    z-index: 2;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    cursor: pointer;
  }
  
  .node.current {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: calc(var(--w) * 0.07) solid rgba(255, 255, 255, 0.4);
    box-shadow: 
      0 8px 24px rgba(102, 126, 234, 0.5),
      0 0 40px rgba(102, 126, 234, 0.3),
      inset 0 1px 0 rgba(255, 255, 255, 0.5);
    animation: nodeGlow 2s ease-in-out infinite;
  }
  
  .node.current:hover {
    transform: translate(-50%, -55%) scale(1.1);
  }
  
  .node.locked {
    background: linear-gradient(135deg, #cbd5e1 0%, #94a3b8 100%);
    border: calc(var(--w) * 0.07) solid rgba(148, 163, 184, 0.5);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    opacity: 0.7;
    cursor: not-allowed;
  }

  /* Play button with pulse */
  @keyframes pulse {
    0%, 100% { transform: translateX(-50%) scale(1); }
    50% { transform: translateX(-50%) scale(1.05); }
  }

  .play {
    position: absolute;
    left: 50%;
    bottom: 88px;
    transform: translateX(-50%);
    width: 200px;
    height: 90px;
    border-radius: 100px;
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    border: 7px solid rgba(255, 255, 255, 0.3);
    box-shadow: 
      0 12px 0 #065f46,
      0 20px 40px rgba(0, 0, 0, 0.4),
      inset 0 2px 0 rgba(255, 255, 255, 0.4);
    display: grid;
    place-items: center;
    cursor: pointer;
    transition: all 0.2s ease;
    animation: pulse 2s ease-in-out infinite;
  }
  
  .play:hover {
    transform: translateX(-50%) scale(1.08);
    box-shadow: 
      0 12px 0 #065f46,
      0 25px 50px rgba(0, 0, 0, 0.5),
      inset 0 2px 0 rgba(255, 255, 255, 0.4);
  }
  
  .play:active {
    transform: translateX(-50%) translateY(4px) scale(1.05);
    box-shadow: 
      0 8px 0 #065f46,
      0 15px 30px rgba(0, 0, 0, 0.4);
  }
  
  .play svg {
    width: 44px;
    height: 44px;
    fill: #fff;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
  }

  svg.overlay{position:absolute; inset:0; z-index:1; pointer-events:none}
  .overlay path{stroke:transparent; fill:none}
  .debug .overlay path{stroke:red; stroke-width:6; opacity:.8; filter:drop-shadow(0 0 3px #fff)}

  /* Debug overlay text */
  .tip{display:none; position:absolute; top:8px; left:8px; background:#0007; color:#fff;
       padding:6px 8px; border-radius:8px; font:12px/1.3 system-ui; z-index:10}
  .debug .tip{display:block}
  .coords{display:none; position:absolute; top:40px; left:8px; background:#0009; color:#fff;
          padding:4px 8px; border-radius:8px; font:12px/1.3 monospace; z-index:10;}
  .debug .coords{display:block}
</style>
</head>
<body>
  <div class="screen" id="screen">
    <div class="bg"></div>

    <div class="title">
      <div class="c">COLOR</div>
      <div class="w">WEAVER</div>
    </div>

    <!-- PATH giữ nguyên để debug nếu cần -->
    <svg class="overlay" viewBox="0 0 1000 2000" preserveAspectRatio="none" id="overlay">
      <path id="levelPath"
  d="
    M 504 1768
    C 540 1708, 596 1648, 656 1588
    S 800 1428, 710 1346
    S 520 1228, 430 1148
    S 328 1008, 432 936
    S 700 864, 900 792
  " />
    </svg>
    <div class="tip">DEBUG: nhấn <b>D</b> bật/tắt path. Giữ chuột để xem toạ độ (x,y).</div>
    <div class="coords" id="coords">x:0, y:0</div>

    <!-- Levels -->
    <div class="node current" id="n1">1</div>
    <div class="node locked"  id="n2">2</div>
    <div class="node locked"  id="n3">3</div>
    <div class="node locked"  id="n4">4</div>
    <div class="node locked"  id="n5">5</div>
    <div class="node locked"  id="n6">6</div>
    <div class="node locked"  id="n7">7</div>
    <div class="node locked"  id="n8">8</div>
    <div class="node locked"  id="n9">9</div>
    <div class="node locked"  id="n10">10</div>

    <div class="play"><svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg></div>
  </div>

<script>
  // ====== TOẠ ĐỘ 10 CỤC (theo hệ viewBox 1000×2000) ======
  const POINTS = [
    {x:  500, y:   1406}, // 1
    {x:  500, y:  1257}, // 2
    {x: 353, y: 1225}, // 3
    {x: 225, y: 1174}, // 4
    {x: 230, y: 1083}, // 5
    {x: 360, y: 1043}, // 6
    {x: 537, y: 1005}, // 7
    {x: 677, y:  979}, // 8
    {x: 763, y:  968}, // 9
    {x: 840, y:  939}, // 10
  ];

  // Kích thước: gần (y lớn) to hơn – xa (y nhỏ) nhỏ hơn
  const SIZE_NEAR = 60;
  const SIZE_FAR  = 14;

  const nodes = ['n1','n2','n3','n4','n5','n6','n7','n8','n9','n10']
    .map(id => document.getElementById(id));

  const screen   = document.getElementById('screen');
  const coordsEl = document.getElementById('coords');

  function placeNodes(){
    const rect = screen.getBoundingClientRect();
    const sx = rect.width  / 1000;
    const sy = rect.height / 2000;

    const minY = Math.min(...POINTS.map(p=>p.y));
    const maxY = Math.max(...POINTS.map(p=>p.y));

    POINTS.forEach((pt,i)=>{
      const el = nodes[i];
      if(!el) return;

      const x = pt.x * sx;
      const y = pt.y * sy;

      // 0 (gần) -> 1 (xa) dựa vào y
      const kFar = (maxY - pt.y) / Math.max(1, (maxY - minY));
      const size = SIZE_NEAR + (SIZE_FAR - SIZE_NEAR) * kFar;

      const shY  = Math.round(size*0.16);
      const blur = Math.round(size*0.45);

      el.style.left = x + 'px';
      el.style.top  = y + 'px';
      el.style.setProperty('--w', size + 'px');
      el.style.zIndex = String(1000 - Math.round(kFar * 1000));
      el.style.boxShadow = `0 ${shY}px 0 rgba(13,33,54,.35), 0 ${Math.round(shY*1.4)}px ${blur}px rgba(0,0,0,.28)`;
    });
  }

  window.addEventListener('resize', placeNodes);
  placeNodes();

  // Toggle debug mode
  window.addEventListener('keydown',e=>{
    if(e.key.toLowerCase()==='d') screen.classList.toggle('debug');
  });

  // Hiển thị tọa độ chuột (viewBox 0–1000,0–2000)
  screen.addEventListener('mousemove',e=>{
    if(!screen.classList.contains('debug')) return;
    const rect=screen.getBoundingClientRect();
    const x=Math.round(e.offsetX/rect.width*1000);
    const y=Math.round(e.offsetY/rect.height*2000);
    coordsEl.textContent=`x:${x}, y:${y}`;
  });

  let selectedLevel = 1;

  // đánh dấu clickable cho các node
  nodes.forEach((el, i) => {
    if (!el) return;
    el.style.cursor = 'pointer';
    el.setAttribute('role', 'button');
    el.setAttribute('aria-label', `Level ${i+1}`);

    el.addEventListener('click', () => {
      selectedLevel = i + 1;
      // đổi trạng thái highlight
      nodes.forEach(n => n && n.classList.remove('current'));
      el.classList.add('current');
    });
  });

  // nút Play → sang màn chơi, truyền ?level=
  const playBtn = document.querySelector('.play');
  playBtn.style.cursor = 'pointer';
  playBtn.addEventListener('click', () => {
    // hiệu ứng nhỏ rồi chuyển trang (tuỳ thích)
    playBtn.style.transform = 'translateX(-50%) scale(0.97)';
    setTimeout(() => {
      window.location.href = `play.html?level=${selectedLevel}`;
    }, 120);
  });
</script>
</body>
</html>
