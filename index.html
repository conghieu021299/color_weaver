<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>Color Weaver – Path Debug with Coordinates</title>
<style>
  :root{ --green:#4cd178; --green-deep:#0e8a4b; }
  *{box-sizing:border-box} html,body{height:100%;margin:0;font-family:system-ui,Inter,Arial}
  body{background:#89d5ff;display:grid;place-items:center}

  .screen{
    position:relative; width:min(430px,100vw);
    height:calc(min(430px,100vw)*2); max-height:100vh;
    overflow:hidden; border-radius:22px; box-shadow:0 20px 60px rgba(0,0,0,.35);
  }
  .bg{position:absolute; inset:0; background:url('https://conghieu021299.github.io/color_weaver/img/background.png') center/cover no-repeat; z-index:0}

  .title{position:absolute; top:120px; left:50%; transform:translateX(-50%); text-align:center; z-index:1}
  .title .c{margin:0; font-weight:900; font-size:52px; color:#38b6ff; text-shadow:0 4px 0 #fff}
  .title .w{margin:-6px 0 0; font-weight:900; font-size:56px; color:#ffb400; text-shadow:0 4px 0 #fff}

  .node{
    --w:74px; position:absolute; width:var(--w); height:calc(var(--w)*0.92);
    border-radius:calc(var(--w)*0.24);
    display:grid; place-items:center; transform:translate(-50%,-55%);
    font-weight:900; font-size:calc(var(--w)*0.38); color:#fff; text-shadow:0 2px 0 #0003; z-index:2;
  }
  .node.current{background:linear-gradient(#79f095,#22b753); border:calc(var(--w)*0.06) solid var(--green-deep)}
  .node.locked {background:linear-gradient(#d8dde5,#aeb6c2); border:calc(var(--w)*0.06) solid #8c95a2}

  .play{position:absolute; left:50%; bottom:88px; transform:translateX(-50%);
    width:180px;height:84px;border-radius:100px; background:linear-gradient(#7cf2a1,#22b753);
    border:6px solid var(--green-deep); box-shadow:0 12px 0 #095c32, 0 22px 34px rgba(0,0,0,.35); display:grid; place-items:center}
  .play svg{width:40px;height:40px;fill:#fff}

  svg.overlay{position:absolute; inset:0; z-index:1; pointer-events:none}
  .overlay path{stroke:transparent; fill:none}
  .debug .overlay path{stroke:red; stroke-width:6; opacity:.8; filter:drop-shadow(0 0 3px #fff)}

  /* Debug overlay text */
  .tip{display:none; position:absolute; top:8px; left:8px; background:#0007; color:#fff;
       padding:6px 8px; border-radius:8px; font:12px/1.3 system-ui; z-index:10}
  .debug .tip{display:block}
  .coords{display:none; position:absolute; top:40px; left:8px; background:#0009; color:#fff;
          padding:4px 8px; border-radius:8px; font:12px/1.3 monospace; z-index:10;}
  .debug .coords{display:block}
</style>
</head>
<body>
  <div class="screen" id="screen">
    <div class="bg"></div>

    <div class="title">
      <div class="c">COLOR</div>
      <div class="w">WEAVER</div>
    </div>

    <!-- PATH giữ nguyên để debug nếu cần -->
    <svg class="overlay" viewBox="0 0 1000 2000" preserveAspectRatio="none" id="overlay">
      <path id="levelPath"
  d="
    M 504 1768
    C 540 1708, 596 1648, 656 1588
    S 800 1428, 710 1346
    S 520 1228, 430 1148
    S 328 1008, 432 936
    S 700 864, 900 792
  " />
    </svg>
    <div class="tip">DEBUG: nhấn <b>D</b> bật/tắt path. Giữ chuột để xem toạ độ (x,y).</div>
    <div class="coords" id="coords">x:0, y:0</div>

    <!-- Levels -->
    <div class="node current" id="n1">1</div>
    <div class="node locked"  id="n2">2</div>
    <div class="node locked"  id="n3">3</div>
    <div class="node locked"  id="n4">4</div>
    <div class="node locked"  id="n5">5</div>
    <div class="node locked"  id="n6">6</div>
    <div class="node locked"  id="n7">7</div>
    <div class="node locked"  id="n8">8</div>
    <div class="node locked"  id="n9">9</div>
    <div class="node locked"  id="n10">10</div>

    <div class="play"><svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg></div>
  </div>

<script>
  // ====== TOẠ ĐỘ 10 CỤC (theo hệ viewBox 1000×2000) ======
  const POINTS = [
    {x:  500, y:   1406}, // 1
    {x:  500, y:  1257}, // 2
    {x: 353, y: 1225}, // 3
    {x: 225, y: 1174}, // 4
    {x: 230, y: 1083}, // 5
    {x: 360, y: 1043}, // 6
    {x: 537, y: 1005}, // 7
    {x: 677, y:  979}, // 8
    {x: 763, y:  968}, // 9
    {x: 840, y:  939}, // 10
  ];

  // Kích thước: gần (y lớn) to hơn – xa (y nhỏ) nhỏ hơn
  const SIZE_NEAR = 60;
  const SIZE_FAR  = 14;

  const nodes = ['n1','n2','n3','n4','n5','n6','n7','n8','n9','n10']
    .map(id => document.getElementById(id));

  const screen   = document.getElementById('screen');
  const coordsEl = document.getElementById('coords');

  function placeNodes(){
    const rect = screen.getBoundingClientRect();
    const sx = rect.width  / 1000;
    const sy = rect.height / 2000;

    const minY = Math.min(...POINTS.map(p=>p.y));
    const maxY = Math.max(...POINTS.map(p=>p.y));

    POINTS.forEach((pt,i)=>{
      const el = nodes[i];
      if(!el) return;

      const x = pt.x * sx;
      const y = pt.y * sy;

      // 0 (gần) -> 1 (xa) dựa vào y
      const kFar = (maxY - pt.y) / Math.max(1, (maxY - minY));
      const size = SIZE_NEAR + (SIZE_FAR - SIZE_NEAR) * kFar;

      const shY  = Math.round(size*0.16);
      const blur = Math.round(size*0.45);

      el.style.left = x + 'px';
      el.style.top  = y + 'px';
      el.style.setProperty('--w', size + 'px');
      el.style.zIndex = String(1000 - Math.round(kFar * 1000));
      el.style.boxShadow = `0 ${shY}px 0 rgba(13,33,54,.35), 0 ${Math.round(shY*1.4)}px ${blur}px rgba(0,0,0,.28)`;
    });
  }

  window.addEventListener('resize', placeNodes);
  placeNodes();

  // Toggle debug mode
  window.addEventListener('keydown',e=>{
    if(e.key.toLowerCase()==='d') screen.classList.toggle('debug');
  });

  // Hiển thị tọa độ chuột (viewBox 0–1000,0–2000)
  screen.addEventListener('mousemove',e=>{
    if(!screen.classList.contains('debug')) return;
    const rect=screen.getBoundingClientRect();
    const x=Math.round(e.offsetX/rect.width*1000);
    const y=Math.round(e.offsetY/rect.height*2000);
    coordsEl.textContent=`x:${x}, y:${y}`;
  });

  let selectedLevel = 1;

  // đánh dấu clickable cho các node
  nodes.forEach((el, i) => {
    if (!el) return;
    el.style.cursor = 'pointer';
    el.setAttribute('role', 'button');
    el.setAttribute('aria-label', `Level ${i+1}`);

    el.addEventListener('click', () => {
      selectedLevel = i + 1;
      // đổi trạng thái highlight
      nodes.forEach(n => n && n.classList.remove('current'));
      el.classList.add('current');
    });
  });

  // nút Play → sang màn chơi, truyền ?level=
  const playBtn = document.querySelector('.play');
  playBtn.style.cursor = 'pointer';
  playBtn.addEventListener('click', () => {
    // hiệu ứng nhỏ rồi chuyển trang (tuỳ thích)
    playBtn.style.transform = 'translateX(-50%) scale(0.97)';
    setTimeout(() => {
      window.location.href = `play.html?level=${selectedLevel}`;
    }, 120);
  });
</script>
</body>
</html>
